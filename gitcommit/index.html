<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>代码整洁之道和 git | books</title>
    <meta name="description" content="个人收藏夹">
    <link rel="icon" href="/books/favicon.ico">
    
    <link rel="preload" href="/books/assets/css/0.styles.3bf99c69.css" as="style"><link rel="preload" href="/books/assets/js/app.b36598ad.js" as="script"><link rel="preload" href="/books/assets/js/48.3b667ef9.js" as="script"><link rel="prefetch" href="/books/assets/js/10.7897c5b8.js"><link rel="prefetch" href="/books/assets/js/11.e894313e.js"><link rel="prefetch" href="/books/assets/js/12.962e2c4f.js"><link rel="prefetch" href="/books/assets/js/13.9201c7e6.js"><link rel="prefetch" href="/books/assets/js/14.0b55444d.js"><link rel="prefetch" href="/books/assets/js/15.3b3bb3a2.js"><link rel="prefetch" href="/books/assets/js/16.8f2c4bea.js"><link rel="prefetch" href="/books/assets/js/17.7654d120.js"><link rel="prefetch" href="/books/assets/js/18.1f7ab18a.js"><link rel="prefetch" href="/books/assets/js/19.c2fca292.js"><link rel="prefetch" href="/books/assets/js/2.854dcf62.js"><link rel="prefetch" href="/books/assets/js/20.aea1b77d.js"><link rel="prefetch" href="/books/assets/js/21.c526f4c7.js"><link rel="prefetch" href="/books/assets/js/22.0bf0a208.js"><link rel="prefetch" href="/books/assets/js/23.59f9e2aa.js"><link rel="prefetch" href="/books/assets/js/24.725d88fc.js"><link rel="prefetch" href="/books/assets/js/25.10d52890.js"><link rel="prefetch" href="/books/assets/js/26.009f0277.js"><link rel="prefetch" href="/books/assets/js/27.02ad3b73.js"><link rel="prefetch" href="/books/assets/js/28.203a6daf.js"><link rel="prefetch" href="/books/assets/js/29.46c08610.js"><link rel="prefetch" href="/books/assets/js/3.8b2a45ed.js"><link rel="prefetch" href="/books/assets/js/30.820acf4b.js"><link rel="prefetch" href="/books/assets/js/31.50888028.js"><link rel="prefetch" href="/books/assets/js/32.595bc6da.js"><link rel="prefetch" href="/books/assets/js/33.faae8c92.js"><link rel="prefetch" href="/books/assets/js/34.bb3ad3b5.js"><link rel="prefetch" href="/books/assets/js/35.aea321d7.js"><link rel="prefetch" href="/books/assets/js/36.db3c532a.js"><link rel="prefetch" href="/books/assets/js/37.2becdc05.js"><link rel="prefetch" href="/books/assets/js/38.96b2e4f2.js"><link rel="prefetch" href="/books/assets/js/39.b167b6ef.js"><link rel="prefetch" href="/books/assets/js/4.c4f29f89.js"><link rel="prefetch" href="/books/assets/js/40.2ca9b918.js"><link rel="prefetch" href="/books/assets/js/41.fbfdaee3.js"><link rel="prefetch" href="/books/assets/js/42.a4739ab1.js"><link rel="prefetch" href="/books/assets/js/43.28ad91e9.js"><link rel="prefetch" href="/books/assets/js/44.a9a3edaa.js"><link rel="prefetch" href="/books/assets/js/45.abbb313c.js"><link rel="prefetch" href="/books/assets/js/46.4eb51b82.js"><link rel="prefetch" href="/books/assets/js/47.56bfa831.js"><link rel="prefetch" href="/books/assets/js/49.ca302f86.js"><link rel="prefetch" href="/books/assets/js/5.7590f93c.js"><link rel="prefetch" href="/books/assets/js/50.1928e985.js"><link rel="prefetch" href="/books/assets/js/51.7e28878b.js"><link rel="prefetch" href="/books/assets/js/52.d89f2d14.js"><link rel="prefetch" href="/books/assets/js/53.b4ff237f.js"><link rel="prefetch" href="/books/assets/js/54.3652c567.js"><link rel="prefetch" href="/books/assets/js/55.d9ea3aea.js"><link rel="prefetch" href="/books/assets/js/56.0110954b.js"><link rel="prefetch" href="/books/assets/js/57.3a69bcfc.js"><link rel="prefetch" href="/books/assets/js/58.ab353971.js"><link rel="prefetch" href="/books/assets/js/59.953ccfa9.js"><link rel="prefetch" href="/books/assets/js/6.6174f641.js"><link rel="prefetch" href="/books/assets/js/60.efd03434.js"><link rel="prefetch" href="/books/assets/js/61.bd9f009e.js"><link rel="prefetch" href="/books/assets/js/62.15e1ab44.js"><link rel="prefetch" href="/books/assets/js/63.16d3a4df.js"><link rel="prefetch" href="/books/assets/js/64.a0954bd4.js"><link rel="prefetch" href="/books/assets/js/65.7f913bc2.js"><link rel="prefetch" href="/books/assets/js/66.dcc05852.js"><link rel="prefetch" href="/books/assets/js/67.1470a51f.js"><link rel="prefetch" href="/books/assets/js/68.11002c8e.js"><link rel="prefetch" href="/books/assets/js/69.390f12c1.js"><link rel="prefetch" href="/books/assets/js/7.6ca50e07.js"><link rel="prefetch" href="/books/assets/js/70.03aa08fb.js"><link rel="prefetch" href="/books/assets/js/71.6ea02cb9.js"><link rel="prefetch" href="/books/assets/js/72.351fb33a.js"><link rel="prefetch" href="/books/assets/js/73.8c65e50d.js"><link rel="prefetch" href="/books/assets/js/74.18429298.js"><link rel="prefetch" href="/books/assets/js/75.7b992bc1.js"><link rel="prefetch" href="/books/assets/js/76.fe474c6d.js"><link rel="prefetch" href="/books/assets/js/77.8e28d671.js"><link rel="prefetch" href="/books/assets/js/78.4ace73ca.js"><link rel="prefetch" href="/books/assets/js/79.8422084d.js"><link rel="prefetch" href="/books/assets/js/8.957cb170.js"><link rel="prefetch" href="/books/assets/js/80.d0153dac.js"><link rel="prefetch" href="/books/assets/js/81.8b346674.js"><link rel="prefetch" href="/books/assets/js/82.ddfadeea.js"><link rel="prefetch" href="/books/assets/js/9.9308df7e.js">
    <link rel="stylesheet" href="/books/assets/css/0.styles.3bf99c69.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/books/" class="home-link router-link-active"><!----> <span class="site-name">books</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/books/" class="nav-link">首页</a></div><div class="nav-item"><a href="/books/repository/" class="nav-link">库</a></div><div class="nav-item"><a href="/books/gitcommit/" aria-current="page" class="nav-link router-link-exact-active router-link-active">gitcommit</a></div><div class="nav-item"><a href="/books/uniapp/" class="nav-link">uniapp开发实践</a></div><div class="nav-item"><a href="/books/typeScript/" class="nav-link">TypeScript</a></div><div class="nav-item"><a href="/books/misc/" class="nav-link">杂项</a></div><div class="nav-item"><a href="/books/website/" class="nav-link">网站</a></div><div class="nav-item"><a href="/books/article/" class="nav-link">文章</a></div><div class="nav-item"><a href="/books/interview/" class="nav-link">面试</a></div><div class="nav-item"><a href="/books/blog/" class="nav-link">Blog</a></div> <a href="https://github.com/yuguaa/books" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/books/" class="nav-link">首页</a></div><div class="nav-item"><a href="/books/repository/" class="nav-link">库</a></div><div class="nav-item"><a href="/books/gitcommit/" aria-current="page" class="nav-link router-link-exact-active router-link-active">gitcommit</a></div><div class="nav-item"><a href="/books/uniapp/" class="nav-link">uniapp开发实践</a></div><div class="nav-item"><a href="/books/typeScript/" class="nav-link">TypeScript</a></div><div class="nav-item"><a href="/books/misc/" class="nav-link">杂项</a></div><div class="nav-item"><a href="/books/website/" class="nav-link">网站</a></div><div class="nav-item"><a href="/books/article/" class="nav-link">文章</a></div><div class="nav-item"><a href="/books/interview/" class="nav-link">面试</a></div><div class="nav-item"><a href="/books/blog/" class="nav-link">Blog</a></div> <a href="https://github.com/yuguaa/books" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>代码整洁之道和 git</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/books/gitcommit/#类" class="sidebar-link">类</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/gitcommit/#git-提交规范" class="sidebar-link">GIT 提交规范</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/gitcommit/#为什么要规范提交信息" class="sidebar-link">为什么要规范提交信息</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/gitcommit/#先看大厂（大佬）提交的规范。" class="sidebar-link">先看大厂（大佬）提交的规范。</a></li><li class="sidebar-sub-header"><a href="/books/gitcommit/#优秀开源作品" class="sidebar-link">优秀开源作品</a></li><li class="sidebar-sub-header"><a href="/books/gitcommit/#规范流程" class="sidebar-link">规范流程</a></li><li class="sidebar-sub-header"><a href="/books/gitcommit/#使用什么规范" class="sidebar-link">使用什么规范</a></li><li class="sidebar-sub-header"><a href="/books/gitcommit/#规范说明" class="sidebar-link">规范说明</a></li><li class="sidebar-sub-header"><a href="/books/gitcommit/#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/books/gitcommit/#扩展-1-格式校验-commitlint" class="sidebar-link">扩展 1 格式校验 commitlint</a></li><li class="sidebar-sub-header"><a href="/books/gitcommit/#扩展-2-自动版本管理和生成-changelog" class="sidebar-link">扩展 2 自动版本管理和生成 CHANGELOG</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="代码整洁之道和-git"><a href="#代码整洁之道和-git" class="header-anchor">#</a> 代码整洁之道和 git</h1> <h2 id="类"><a href="#类" class="header-anchor">#</a> 类</h2> <p>1、类应该从一组变量列表开始。如果有公共静态常量，应该先出现。然后是私有静态变量，以及私有实体变量。很少会有公共变量。公共函数应跟在变量列表之后。而公共函数调用的私有工具函数紧随在该公共函数后面。这符合了自顶向下原则，让程序读起来就像一篇报纸文章。</p> <p>2、想办法使之保有隐私。放松封装总是下策。</p> <p><strong>3、类应该短小，这个短小用类的权责来衡量。类的名称应当描述其权责。实际上，命名正是帮助判断类的长度的第一个手段。如果无法为某个类命以精确的名称，这个类大概就太长了。类名越含混，该类越有可能拥有过多权责。</strong></p> <p><strong>4、单一权责原则。单一权责原则（SRP）认为，类或模块应有且只有一条加以修改的理由。如果一个类承担的职责过多，就等于把这些职责<a href="https://baike.baidu.com/item/%E8%80%A6%E5%90%88/2821124" target="_blank" rel="noopener noreferrer">耦合<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>在一起了。一个职责的变化可能会削弱或者抑制这个类完成其他职责的能力。这种耦合会导致脆弱的设计，当发生变化时，设计会遭受到意想不到的破坏。而如果想要避免这种现象的发生，就要尽可能的遵守单一职责原则。此原则的核心就是<a href="https://baike.baidu.com/item/%E8%A7%A3%E8%80%A6" target="_blank" rel="noopener noreferrer">解耦<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>和增强<a href="https://baike.baidu.com/item/%E5%86%85%E8%81%9A%E6%80%A7/4973441" target="_blank" rel="noopener noreferrer">内聚性<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</strong></p> <p>5、系统应该由许多短小的类而不是少量巨大的类组成。每个小类封装一个权责，只有一个修改的原因，并与少数其他类一起协同达成期望的系统行为。</p> <p>6、类应该只有少量实体变量。类中的每个方法都应该操作一个或多个这种变量。保持函数和参数列表短小的策略，有时会导致为一组子集方法所用的实体变量数量增加。出现这种情况时，往往意味着至少有一个类要从大类中挣扎出来。你应当尝试将这些变量和方法分拆到两个或多个类中，让新的类更为内聚。</p> <p>7、将大函数拆为许多小函数，往往也是将类拆分为多个小类的时机。因为这往往会多出许多实体变量，降低了类的内聚性。</p> <p><strong>8、开放-闭合原则（OCP）：类应当对扩展开放，对修改封闭、</strong></p> <p>9、在理想系统中，我们通过扩展系统而非修改现有代码来添加新特性。</p> <p>10、依赖倒置原则（Dependency Inversion Principle, DIP）。类应当依赖于抽象而不是依赖于具体细节。</p> <img src="https://static01.imgkr.com/temp/8ca90d6945fa45c088b49fa34e9f5944.png" alt="代码"> <img src="https://static01.imgkr.com/temp/569632add7274dc0ad4437ecd553c7c3.png" alt="结果"> <p><strong>感受：类和方法都只做好一件事</strong></p> <h2 id="git-提交规范"><a href="#git-提交规范" class="header-anchor">#</a> GIT 提交规范</h2> <p><code>git</code>作为一个开发人员必不可少的工具，代码提交也是日常一个非常频繁的操作，如果你或你的团队目前对提交信息还没有一个规范或约束，那么你有必要看看本文的内容了。</p> <h2 id="为什么要规范提交信息"><a href="#为什么要规范提交信息" class="header-anchor">#</a> 为什么要规范提交信息</h2> <p>首先规范提交信息肯定是有必要的，简单总结下几点好处：</p> <ul><li>让项目的维护或使用人员能了解提交了哪些更改</li> <li>清晰的历史记录，可能某天自己就需要查到呢</li> <li>规范的提交记录可用于自动生成修改日志(CHANGELOG.md)</li> <li>基于提交类型，触发构建和部署流程</li></ul> <h3 id="先看大厂（大佬）提交的规范。"><a href="#先看大厂（大佬）提交的规范。" class="header-anchor">#</a> <strong>先看大厂（大佬）提交的规范。</strong></h3> <p><img src="https://static01.imgkr.com/temp/76eda84d309c415ea405152611f34904.png" alt="大佬提交规范"></p> <p><img src="https://static01.imgkr.com/temp/539dcc22ccbf4719aedb394ce476f1f7.png" alt="大佬项目日志"></p> <h3 id="优秀开源作品"><a href="#优秀开源作品" class="header-anchor">#</a> <strong>优秀开源作品</strong></h3> <p><img src="https://static01.imgkr.com/temp/edec3c9b9b904d24bf5f0edb99c97c29.png" alt="vben-admin"> <img src="https://static01.imgkr.com/temp/e992837edb1e426299b505a88325bc7c.png" alt="vben-admin-chang"></p> <p>在项目开发中，通常都会涉及到多人合作，那么经常就会出现代码风格不一致、提交信息混乱甚至还有代码报错的情况。有可能从远程仓库拉取下来的代码与你的本地代码只是格式不一致而引起冲突或者不是你使用的代码风格，还得去修复和调整。</p> <p><img src="https://img-blog.csdnimg.cn/img_convert/340b445cfa9187c78c65a864a53b0187.png" alt="340b445cfa9187c78c65a864a53b0187.png"></p> <h3 id="规范流程"><a href="#规范流程" class="header-anchor">#</a> <strong>规范流程</strong></h3> <p>就个人理解开发规范流程包含了代码语法规则检查(<code>Linter</code>)、代码风格格式化(<code>Formatter</code>)以及 git 提交校验(<code>Pre-Commit Check</code>)等。</p> <ul><li>代码语法规则检查：主要是指利用一些代码检测工具(如<code>ESLint</code>、<code>TSLint</code>等)对语法规则和代码风格进行检查、提示以及自动修复。比如禁止使用<code>==</code>、禁止在变量定义之前使用它们等，其中的校验规则是可以根据团队和个人的习惯自由配置的。</li> <li>代码风格格式化：是指利用一些代码格式化工具(如<code>ESLint</code>、<code>Prettier</code>等)根据设定规则重新输出格式规范的代码，以避免因不同成员代码风格不一致而产生冲突和带来的代码阅读、理解成本。</li> <li>git 提交校验：是指在代码提交时，调用<code>pre-commit</code>钩子对代码语法和代码风格进行检查和修复，调用<code>commit-msg</code>钩子对 commit message 进行校验。若校验未通过，则提交失败，并抛出相应错误。</li></ul> <h3 id="使用什么规范"><a href="#使用什么规范" class="header-anchor">#</a> 使用什么规范</h3> <p><strong><code>Conventional Commits</code>(约定式提交规范)</strong>，是目前使用最广泛的提交信息规范，其主要受 <a href="https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines" target="_blank" rel="noopener noreferrer">AngularJS 规范 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的启发,下面是一个规范信息的结构：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>type<span class="token operator">&gt;</span><span class="token punctuation">[</span>optional scope<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token operator">&lt;</span>subject<span class="token operator">&gt;</span>
<span class="token comment">//空一行</span>
<span class="token punctuation">[</span>optional body<span class="token punctuation">]</span>
<span class="token comment">//空一行</span>
<span class="token punctuation">[</span>optional <span class="token function">footer</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="规范说明"><a href="#规范说明" class="header-anchor">#</a> 规范说明</h3> <p><strong><code>type</code></strong> 提交的类别，必须是以下类型中的一个</p> <div class="language- extra-class"><pre class="language-text"><code>feat：增加一个新功能
fix：修复bug
docs：只修改了文档
style：做了不影响代码含义的修改，空格、格式化、缺少分号等等
refactor：代码重构，既不是修复bug，也不是新功能的修改
perf：改进性能的代码
test：增加测试或更新已有的测试
chore：构建或辅助工具或依赖库的更新
</code></pre></div><p><strong><code>scope</code></strong> 可选，表示影响的范围、功能、模块</p> <p><strong><code>subject</code></strong> 必填，简单说明，不超过 50 个字</p> <p><strong><code>body</code></strong> 选填，用于填写更详细的描述</p> <p><strong><code>footer</code></strong> 选填，用于填关联<code>issus</code>,或<code>BREAK CHANGE</code></p> <h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <ul><li><strong>安装</strong></li></ul> <div class="language-cmd extra-class"><pre class="language-text"><code># 或者本地安装
$ npm install --save-dev commitizen
# 安装适配器
npm install cz-conventional-changelog --save-dev
</code></pre></div><ul><li><strong><code>packages.json</code>在配置文件中指定使用哪种规范</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>&quot;config&quot;: {
    &quot;commitizen&quot;: {
      &quot;path&quot;: &quot;cz-conventional-changelog&quot;
    }
  }
</code></pre></div><ul><li><strong>安装完成后可以使用<code>npm run commit</code> 来代替<code>git commit</code>,然后根据提示一步步输入即可</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>{
&quot;commit&quot;: &quot;git-cz&quot;
}
</code></pre></div><p><img src="https://static01.imgkr.com/temp/d3a442683e464099988c6a2b7716c262.png" alt="git1"></p> <p><img src="https://static01.imgkr.com/temp/e21f48ad28394723811aee97965cab39.png" alt="git2"></p> <ul><li><p><strong>生成 changelog 脚本</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;log&quot;</span><span class="token operator">:</span> <span class="token string">&quot;conventional-changelog -p angular -i CHANGELOG.md -s&quot;</span><span class="token punctuation">,</span><span class="token comment">//追加log</span>
<span class="token string">&quot;log:f&quot;</span><span class="token operator">:</span> <span class="token string">&quot;conventional-changelog -p angular -i CHANGELOG.md -s -r 0&quot;</span><span class="token punctuation">,</span><span class="token comment">//第一次生成log</span>
</code></pre></div><p><img src="https://static01.imgkr.com/temp/1c0ac97335ae43079dd2ce84842d5475.png" alt="log"></p></li></ul> <h3 id="扩展-1-格式校验-commitlint"><a href="#扩展-1-格式校验-commitlint" class="header-anchor">#</a> 扩展 1 格式校验 commitlint</h3> <p>可能你不想每次都通过交互界面来生成，还是想使用<code>git commit -m 'message'</code>，那么为了确保信息的正确性，可以结合<code>husky</code>对提交的信息进行格式验证</p> <ul><li><strong>安装依赖</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>npm install --save-dev @commitlint/config-conventional @commitlint/cli
# 安装husky
npm install --save-dev husky
</code></pre></div><ul><li><strong>添加 <code>commitlint.config.js</code>文件到项目</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  ignores<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token parameter">commit</span> <span class="token operator">=&gt;</span> commit<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'init'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@commitlint/config-conventional'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  parserPreset<span class="token operator">:</span> <span class="token punctuation">{</span>
    parserOpts<span class="token operator">:</span> <span class="token punctuation">{</span>
      headerPattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(\w*|[\u4e00-\u9fa5]*)(?:[\(\（](.*)[\)\）])?[\:\：] (.*)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      headerCorrespondence<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'scope'</span><span class="token punctuation">,</span> <span class="token string">'subject'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      referenceActions<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'close'</span><span class="token punctuation">,</span>
        <span class="token string">'closes'</span><span class="token punctuation">,</span>
        <span class="token string">'closed'</span><span class="token punctuation">,</span>
        <span class="token string">'fix'</span><span class="token punctuation">,</span>
        <span class="token string">'fixes'</span><span class="token punctuation">,</span>
        <span class="token string">'fixed'</span><span class="token punctuation">,</span>
        <span class="token string">'resolve'</span><span class="token punctuation">,</span>
        <span class="token string">'resolves'</span><span class="token punctuation">,</span>
        <span class="token string">'resolved'</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      issuePrefixes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'#'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      noteKeywords<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'BREAKING CHANGE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      fieldPattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^-(.*?)-$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      revertPattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^Revert\s&quot;([\s\S]*)&quot;\s*This reverts commit (\w*)\.</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      revertCorrespondence<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'header'</span><span class="token punctuation">,</span> <span class="token string">'hash'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token function">warn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      mergePattern<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      mergeCorrespondence<span class="token operator">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'body-leading-blank'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'always'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'footer-leading-blank'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'always'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'header-max-length'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'always'</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'subject-empty'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'never'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'type-empty'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'never'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'type-enum'</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token string">'always'</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>
        <span class="token string">'feat'</span><span class="token punctuation">,</span>
        <span class="token string">'fix'</span><span class="token punctuation">,</span>
        <span class="token string">'perf'</span><span class="token punctuation">,</span>
        <span class="token string">'style'</span><span class="token punctuation">,</span>
        <span class="token string">'docs'</span><span class="token punctuation">,</span>
        <span class="token string">'test'</span><span class="token punctuation">,</span>
        <span class="token string">'refactor'</span><span class="token punctuation">,</span>
        <span class="token string">'build'</span><span class="token punctuation">,</span>
        <span class="token string">'ci'</span><span class="token punctuation">,</span>
        <span class="token string">'chore'</span><span class="token punctuation">,</span>
        <span class="token string">'revert'</span><span class="token punctuation">,</span>
        <span class="token string">'wip'</span><span class="token punctuation">,</span>
        <span class="token string">'workflow'</span><span class="token punctuation">,</span>
        <span class="token string">'types'</span><span class="token punctuation">,</span>
        <span class="token string">'release'</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong><code>package.json</code>配置</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;commit-msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commitlint -e $HUSKY_GIT_PARAMS&quot;</span><span class="token comment">//这里配置可校验提交信息</span>
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><h3 id="扩展-2-自动版本管理和生成-changelog"><a href="#扩展-2-自动版本管理和生成-changelog" class="header-anchor">#</a> 扩展 2 自动版本管理和生成 CHANGELOG</h3> <ul><li><strong>安装依赖</strong></li></ul> <div class="language- extra-class"><pre class="language-text"><code>npm i standard-version -D
</code></pre></div><ul><li><strong>添加脚本</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;release&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard-version&quot;</span>

<span class="token comment">//其他脚本</span>
<span class="token string">&quot;release:alpha&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard-version --prerelease alpha&quot;</span><span class="token punctuation">,</span>
<span class="token string">&quot;release:rc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard-version --prerelease rc&quot;</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>#指定类型 patch/minor/marjor
npm run release -- --release-as patch
#指定版本号
npm run release -- -- release-as 1.1.0
</code></pre></div><p><img src="https://static01.imgkr.com/temp/abaf1b008a8048c5a90a67230193dbca.png" alt="添加tag"></p> <p><img src="https://static01.imgkr.com/temp/35da8f97e9f54cae8a167a2ba2a84ccf.png" alt="添加changelog"></p> <h5 id="版本格式"><a href="#版本格式" class="header-anchor">#</a> 版本格式</h5> <p>主版本号.次版本号.修订号，版本号递增规则如下：</p> <ul><li>主版本号(major)：当你做了不兼容的 API 修改，</li> <li>次版本号(minor)：当你做了向下兼容的功能性新增，可以理解为 Feature 版本，</li> <li>修订号(patch)：当你做了向下兼容的问题修正，可以理解为 Bug fix 版本。</li></ul> <p>先行版本号可以加到“主版本号.次版本号.修订号”的后面，作为延伸。</p> <h5 id="先行版本"><a href="#先行版本" class="header-anchor">#</a> 先行版本</h5> <p>当即将发布大版本改动前，但是又不能保证这个版本的功能 100% 正常，这个时候可以发布先行版本：</p> <ul><li>alpha: 内部版本</li> <li>beta: 公测版本</li> <li>rc: 候选版本(Release candiate)</li></ul> <p>比如：1.0.0-alpha.0,1.0.0-alpha.1,1.0.0-rc.0,1.0.0-rc.1 等。</p> <p><code>standard-version</code> 会根据提交的信息类型来自动更改对应的版本号,如下:</p> <ul><li>feat: 次版本(minor)+1</li> <li>fix: 修订号(patch) +1</li> <li>BREAK CHANGE: 主板号(marjor) +1</li></ul> <blockquote><p><code>standard-verstion</code> 生成的<code>CHANGELOG</code>只会包含<code>feat</code>,<code>fix</code>,<code>BREACK-CHANGE</code>类型的提交记录</p></blockquote></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/yuguaa/books/edit/master/docs/gitcommit/README.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">5/27/2021, 3:15:16 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/books/assets/js/app.b36598ad.js" defer></script><script src="/books/assets/js/48.3b667ef9.js" defer></script>
  </body>
</html>
